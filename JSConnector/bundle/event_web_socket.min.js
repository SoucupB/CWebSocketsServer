var JSConnector=(()=>{var p=Object.create;var o=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),v=(e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})},u=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of y(t))!O.call(e,n)&&n!==r&&o(e,n,{get:()=>t[n],enumerable:!(s=_(t,n))||s.enumerable});return e};var m=(e,t,r)=>(r=e!=null?p(C(e)):{},u(t||!e||!e.__esModule?o(r,"default",{value:e,enumerable:!0}):r,e)),M=e=>u(o({},"__esModule",{value:!0}),e);var f=g((F,w)=>{"use strict";w.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var U={};v(U,{EventWebSocket:()=>i,default:()=>T});var h=e=>(e.getInt32(4,!0)&16777216)>0,z=e=>e.getInt32(4,!0)&16777215,a=e=>e.getInt32(0,!0),B=(e,t)=>h(t)?e.subarray(8,16):null,E=e=>e.authCode?16:8,x=e=>e.authCode==null?e.code:e.code|16777216,I=e=>e.size+E(e),d=e=>typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e),R=e=>e.authCode?d(e.authCode):null,S=(e,t)=>{let r=0;return h(t)&&(r=8),e.subarray(8+r,8+r+a(t))};function l(e){if(e.length<8)return null;let t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{size:a(t),code:z(t),authCode:B(e,t),payload:S(e,t)}}var A=e=>e.code!=null&&e.authCode!=null&&e.payload!=null;function c(e){if(!A(e))return null;e.size=e.payload.length;let t=new Uint8Array(I(e)),r=new DataView(t.buffer),s=0;r.setInt32(0,e.size,!0),r.setInt32(4,x(e),!0);let n=null;if(e.authCode&&(n=R(e))){if(!n)return null;t.set(n,8),s+=8}return t.set(d(e.payload),8+s),t}var i=class{constructor(t){this.host=t,this.onOpen=null,this.onReceive=null,this.onClose=null,this.onError=null}_onOpen(t){t.onOpen&&t.onOpen()}_onReceive(t,r){t.onReceive&&t.onReceive(l(new Uint8Array(r)))}_setMethods_Node(){let t=this;this.ws.on("open",()=>this._onOpen(t)),this.ws.on("message",r=>this._onReceive(t,r)),this.ws.on("error",r=>this._onError(r))}_setMethods_Browser(){let t=this;this.ws.binaryType="arraybuffer",this.ws.onopen=()=>this._onOpen(t),this.ws.onmessage=r=>this._onReceive(t,r.data),this.ws.onerror=r=>this._onError(r)}_setMethods(){if(!this._isOnBrowser()){this._setMethods_Node();return}this._setMethods_Browser()}_onError(t){this.onError&&this.onError(t)}send(t){let r=c(t);r&&this.ws.send(r)}_isOnBrowser(){return typeof window<"u"}async connect(){let t;this._isOnBrowser()?t=WebSocket:t=(await Promise.resolve().then(()=>m(f(),1))).default;try{this.ws=new t(this.host),this._setMethods()}catch{return!1}return!0}},T=i;return M(U);})();

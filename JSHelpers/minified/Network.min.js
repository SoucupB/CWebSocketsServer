"use strict";(()=>{var s=class{constructor(e){this.url=e,this.jwt=null,this.onReceive=null,this.onDisconnect=null,this.opened=!1,this.loggedIN=!1,this.ws=null}connect(){this.ws=new WebSocket(`ws://${this.url}`),this.setMethods()}_ftypeOf(e){return typeof e=="string"?"string":Array.isArray(e)?"array":e!==null&&typeof e=="object"?"object":"other"}_getBytes_String(e){return new TextEncoder().encode(e)}_getBytes_Array(e){return new Uint8Array(e)}_getBytes_Object(e){return this._getBytes_String(JSON.stringify(e))}_getBytes(e){switch(this._ftypeOf(e)){case"string":return this._getBytes_String(e);case"array":return this._getBytes_Array(e);case"object":return this._getBytes_Object(e)}return null}send(e){let t=this._getBytes(e);t&&this.ws&&this.ws.send(t)}extractData(e){let t=new TextDecoder("utf-8");return JSON.parse(t.decode(e)).status===200}setMethods(){let e=this;this.ws&&(this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{e.opened=!0,this.login()},this.ws.onmessage=t=>{if(!e.loggedIN&&e.extractData(t.data)){e.loggedIN=!0;return}e.ws&&!e.loggedIN&&e.ws.close(),e.onReceive&&e.onReceive(t.data)},this.ws.onerror=t=>{console.error("WebSocket error",t)},this.ws.onclose=t=>{console.log("Disconnected!"),e.onDisconnect&&e.onDisconnect(t.code,t.reason)})}addJWTAuth(e){this.jwt=e}login(){if(!this.jwt||!this.opened||!this.ws)return;let t=new TextEncoder().encode(JSON.stringify({token:this.jwt}));this.ws.send(t)}};globalThis.Network=s;})();
